!function(e){e.module("angular-keenio.config",[]).value("angular-keenio.config",{debug:!0}),e.module("angular-keenio.directives",[]),e.module("angular-keenio.services",[]),e.module("angular-keenio",["angular-keenio.config","angular-keenio.directives","angular-keenio.services"])}(angular),function(e){e.module("angular-keenio.directives").directive("tbkKeenAreachart",[function(){var e={scope:{query:"=",title:"@",width:"@",height:"@",isStacked:"@",chartOptions:"=?",colors:"=?",labels:"=?",colorMapping:"=?",labelMapping:"=?"},controller:["$scope",function(e){e.chartOptions=e.chartOptions||{chartArea:{height:"85%",left:"5%",top:"5%",width:"80%"},isStacked:!!e.isStacked}}],template:'<div data-tbk-keen-chart="areachart"  query="query"  height="{{height}}"  width="{{width}}"  chart-options="chartOptions"  colors="colors"  labels="labels"  color-mapping="colorMapping"  label-Mapping="labelMapping" ></div>'};return e}])}(angular),function(e){e.module("angular-keenio.directives").directive("tbkKeenBarchart",[function(){var e={scope:{query:"=",title:"@",width:"@",height:"@",isStacked:"@",groupWidth:"@",chartOptions:"=?",colors:"=?",labels:"=?",colorMapping:"=?",labelMapping:"=?"},controller:["$scope",function(e){e.chartOptions=e.chartOptions||{chartArea:{height:"85%",left:"5%",top:"5%",width:"100%"},bar:{groupWidth:e.groupWidth||"85%"},isStacked:!!e.isStacked}}],template:'<div data-tbk-keen-chart="barchart"  query="query"  height="{{height}}"  width="{{width}}"  chart-options="chartOptions"  colors="colors"  labels="labels"  color-mapping="colorMapping"  label-Mapping="labelMapping" ></div>'};return e}])}(angular),function(e){e.module("angular-keenio.directives").directive("tbkKeenChart",[function(){var e={scope:{chartType:"@tbkKeenChart",query:"=",title:"@",width:"@",height:"@",chartOptions:"=?",colors:"=?",labels:"=?",colorMapping:"=?",labelMapping:"=?"},controller:["$scope","tbkKeenClient",function(e,t){e.keenClient=t,e.height=e.height||250,e.width=e.width||"auto",e.title=e.title||!1,e.chartOptions=e.chartOptions||{chartArea:{height:"85%",left:"5%",top:"5%",width:"80%"}}}],link:function(e,t){e.keenClient.draw(e.query,t[0],{chartType:e.chartType,title:e.title,height:e.height,width:e.width,chartOptions:e.chartOptions,colors:e.colors,labels:e.labels,colorMapping:e.colorMapping,labelMapping:e.labelMapping})}};return e}])}(angular),function(e){e.module("angular-keenio.directives").directive("tbkKeenColumnchart",[function(){var e={scope:{query:"=",title:"@",width:"@",height:"@",isStacked:"@",groupWidth:"@",chartOptions:"=?",colors:"=?",labels:"=?",colorMapping:"=?",labelMapping:"=?"},controller:["$scope",function(e){e.chartOptions=e.chartOptions||{chartArea:{height:"85%",left:"5%",top:"5%",width:"100%"},bar:{groupWidth:e.groupWidth||"85%"},isStacked:!!e.isStacked}}],template:'<div data-tbk-keen-chart="columnchart"  query="query"  height="{{height}}"  width="{{width}}"  chart-options="chartOptions"  colors="colors"  labels="labels"  color-mapping="colorMapping"  label-Mapping="labelMapping" ></div>'};return e}])}(angular),function(e){e.module("angular-keenio.directives").directive("tbkKeenLinechart",[function(){var e={scope:{query:"=",title:"@",width:"@",height:"@",isStacked:"@",groupWidth:"@",chartOptions:"=?",colors:"=?",labels:"=?",colorMapping:"=?",labelMapping:"=?"},controller:["$scope",function(e){e.chartOptions=e.chartOptions||{chartArea:{height:"85%",left:"5%",top:"5%",width:"100%"},bar:{groupWidth:e.groupWidth||"85%"},isStacked:!!e.isStacked}}],template:'<div data-tbk-keen-chart="linechart"  query="query"  height="{{height}}"  width="{{width}}"  chart-options="chartOptions"  colors="colors"  labels="labels"  color-mapping="colorMapping"  label-Mapping="labelMapping" ></div>'};return e}])}(angular),function(e){e.module("angular-keenio.directives").directive("tbkKeenMetric",["$injector","$filter","tbkKeenClient",function(e,t,r){var i=function(e){var t=e.containerClass||"tbk-keen-metric";return{container:t,loading:e.loadingClass||t+"-loading",error:e.errorClass||t+"-error",success:e.successClass||t+"-success"}},a=function(e){return{prefix:e.prefix||"",postfix:e.postfix||"",loading:e.loadingText||"Loading...",error:e.errorText||"An error occured!"}},n=function(t){var r=t.filter&&e.has(t.filter+"Filter");return{scale:parseInt(t.scale,10)||0,factor:parseFloat(t.factor)||1,filter:r?t.filter:null,useFilter:r}},o={scope:{query:"=",prefix:"@",postfix:"@",scale:"@",factor:"@",filter:"@",loadingText:"@",errorText:"@",containerClass:"@",loadingClass:"@",successClass:"@",errorClass:"@"},controller:["$scope",function(e){e.texts=a(e),e.classes=i(e),e.options=n(e),e.flags={loading:!1,error:!1},e.response=null}],link:function(e,i){i.addClass(e.classes.container);var a=function(){e.result=null,e.response=null,e.error=null,e.flags.loading=!0,e.flags.error=!1,i.addClass(e.classes.loading),i.removeClass(e.classes.success),i.removeClass(e.classes.error)};!function(){a(),r.run(e.query,function(r,a){if(e.response=a,e.error=r,e.flags.error=!!r,e.flags.loading=!1,!r){var n=a.result*e.options.factor;e.result=e.options.useFilter?t(e.options.filter)(n,e.options.scale):t("number")(n,e.options.scale)}i.removeClass(e.classes.loading),i.addClass(r?e.classes.error:e.classes.success),e.$digest()})}()},template:'<span><span data-ng-hide="flags.loading || flags.error">{{ texts.prefix }}{{ result }}{{ texts.postfix }}</span><span data-ng-show="flags.loading">{{ texts.loading }}</span><span data-ng-show="flags.error">{{ texts.error }}</span></span>'};return o}]).directive("tbkKeenDefaultMetric",["$injector","$filter","tbkKeenClient",function(){var e={scope:{analysisType:"@",targetProperty:"@",eventCollection:"@",queryOptions:"=?",prefix:"@",postfix:"@",scale:"@",factor:"@",filter:"@",loadingText:"@",errorText:"@",containerClass:"@",loadingClass:"@",successClass:"@",errorClass:"@"},controller:["$scope","tbkKeen",function(e,t){var r=e.queryOptions||{};r.eventCollection=e.eventCollection,r.targetProperty=e.targetProperty,e.query=new t.Query(e.analysisType,r)}],template:'<span data-tbk-keen-metric  data-query="query"  data-prefix="{{prefix}}"  data-postfix="{{postfix}}"  data-scale="{{scale}}"  data-factor="{{factor}}"  data-filter="{{filter}}"  data-loading-text="{{loadingText}}"  data-error-text="{{errorText}}"  data-container-class="{{containerClass}}"  data-loading-class="{{loadingClass}}"  data-success-class="{{successClass}}"  data-error-class="{{errorClass}}" ></span>'};return e}])}(angular),function(e){e.module("angular-keenio.directives").directive("tbkKeenPiechart",[function(){var e={scope:{query:"=",title:"@",width:"@",height:"@",pieHole:"@",chartOptions:"=?",colors:"=?",labels:"=?",colorMapping:"=?",labelMapping:"=?"},controller:["$scope",function(e){e.chartOptions=e.chartOptions||{chartArea:{height:"85%",left:"5%",top:"5%",width:"100%"},pieHole:e.pieHole||.4}}],template:'<div data-tbk-keen-chart="piechart"  query="query"  height="{{height}}"  width="{{width}}"  chart-options="chartOptions"  colors="colors"  labels="labels"  color-mapping="colorMapping"  label-Mapping="labelMapping" ></div>'};return e}]).directive("tbkKeenDefaultPiechart",[function(){var e={scope:{analysisType:"@",eventCollection:"@",groupBy:"@",queryOptions:"=?",chartOptions:"=?",title:"@",width:"@",height:"@",colors:"=?",labels:"=?",colorMapping:"=?",labelMapping:"=?"},controller:["$scope","tbkKeen",function(e,t){e.analysisType=e.analysisType||"count",e.height=e.height||"250",e.width=e.width||"auto",e.queryOptions=e.queryOptions,e.queryOptions.eventCollection=e.eventCollection,e.queryOptions.groupBy=e.groupBy,e.query=new t.Query(e.analysisType,e.queryOptions),e.chartOptions=e.chartOptions||{chartArea:{height:"85%",left:"5%",top:"5%",width:"100%"},pieHole:.4}}],template:'<div data-tbk-keen-piechart  query="query"  height="{{height}}"  width="{{width}}"  title="{{title}}"  chart-options="chartOptions"  colors="colors"  labels="labels"  color-mapping="colorMapping"  label-Mapping="labelMapping" ></div>'};return e}])}(angular),function(e){e.module("angular-keenio.directives").directive("tbkKeenTable",["tbkKeenClient",function(e){var t={scope:{query:"=",title:"@",height:"@"},controller:["$scope",function(e){e.options={title:e.title||"",height:e.height||340}}],link:function(t,r){e.draw(t.query,r[0],{chartType:"table",title:t.options.title,height:t.options.height})},template:"<div></div>"};return t}]).directive("tbkKeenDefaultTable",[function(){var e={scope:{title:"@",analysisType:"@",eventCollection:"@",queryOptions:"=?"},controller:["$scope","tbkKeen",function(e,t){var r=e.queryOptions||{};r.eventCollection=e.eventCollection,e.analysisType=e.analysisType||"extraction",e.query=new t.Query(e.analysisType,r)}],template:'<div tbk-keen-table  data-query="query"  data-title="{{title}}"></div>'};return e}])}(angular),function(e){e.module("angular-keenio.services").value("tbkKeenDefaultConfig",{projectId:"YOUR_PROJECT_ID",writeKey:"YOUR_WRITE_KEY",readKey:"YOUR_READ_KEY",protocol:"https",host:"api.keen.io/3.0",requestType:"jsonp"}).provider("tbkKeenConfig",[function(){var t={};this.projectId=function(e){return t.projectId=e,this},this.writeKey=function(e){return t.writeKey=e,this},this.readKey=function(e){return t.readKey=e,this},this.protocol=function(e){return t.protocol=e,this},this.host=function(e){return t.host=e,this},this.requestType=function(e){return t.requestType=e,this},this.$get=["tbkKeenDefaultConfig",function(r){return e.extend(r,t)}]}]).factory("tbkKeen",["$window",function(e){return e.Keen}]).factory("tbkKeenClient",["tbkKeen","tbkKeenConfig",function(e,t){return new e(t)}]).factory("tbkKeenHttpGet",["tbkKeenConfig","tbkKeenClient",function(e,t){return function(r,i,a){var n=r.replace("<project_id>",e.projectId),o=e.protocol+"://"+e.host+n;return t.get(o,i,e.readKey,a)}}])}(angular);